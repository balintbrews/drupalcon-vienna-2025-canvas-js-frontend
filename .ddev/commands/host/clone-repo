#!/bin/bash

## Description: Drupal Canvas: Clone the Canvas module repository to the correct location.
## Usage: clone-repo
## Example: "ddev clone-repo"
## ExecRaw: true

REPO_URL="git@git.drupal.org:project/canvas.git"
CONTRIB_DIR="$DDEV_APPROOT/web/modules/contrib"
TARGET_DIR="$DDEV_APPROOT/web/modules/contrib/canvas"

if [ ! -d "$TARGET_DIR" ] || [ -z "$(ls -A "$TARGET_DIR" 2>/dev/null)" ]; then
    echo "Directory $TARGET_DIR doesn't exist or is empty, cloning repositoryâ€¦"
    
    # Create contrib directory if it doesn't exist.
    mkdir -p "$CONTRIB_DIR"
    
    git clone "$REPO_URL" "$TARGET_DIR"
    
    if [ $? -eq 0 ]; then
        echo "Repository cloned successfully to $TARGET_DIR."
    else
        echo "Error: Failed to clone repository."
        exit 1
    fi
else
    echo "Directory $TARGET_DIR already exists, skipping clone."
fi
